--CONSULTAS

--CONSULTAS SIMPLES , REALIZACION DEL MODELO DEL TRABAJO

DROP TABLE PRODUCTOS CASCADE CONSTRAINTS;
DROP TABLE DETALLE CASCADE CONSTRAINTS;
DROP TABLE BOLETA CASCADE CONSTRAINTS;
DROP TABLE CLIENTE CASCADE CONSTRAINTS;


CREATE TABLE CLIENTE (
    
    RUT NUMBER NOT NULL,
    NOMBRE VARCHAR2(30),
    APELLIDOS VARCHAR2(50),
    CORREO VARCHAR2(50) UNIQUE,
    EDAD NUMBER CHECK(EDAD>=18)
);

CREATE TABLE BOLETA (
    
    CODIGOBOLETA NUMBER NOT NULL,
    RUT NUMBER ,
    FECHA DATE,
    TOTAL NUMBER
    

);

CREATE TABLE DETALLE (
    
    CODIGOPRODUCTO NUMBER NOT NULL,
    CODIGOBOLETA NUMBER NOT NULL,
    CANTIDAD NUMBER,
    TOTAL NUMBER


);

CREATE TABLE PRODUCTOS(

    CODIGOPRODUCTO NUMBER NOT NULL,
    NOMBRE VARCHAR2(20),
    PRECIO NUMBER,
    CATEGORIA VARCHAR2(20)
);

-- PK 
ALTER TABLE CLIENTE ADD CONSTRAINT PK_CLIENTE PRIMARY KEY(RUT);
ALTER TABLE BOLETA ADD CONSTRAINT PK_BOLETA PRIMARY KEY(CODIGOBOLETA);
ALTER TABLE DETALLE ADD CONSTRAINT PK_DETALLE PRIMARY KEY(CODIGOPRODUCTO, CODIGOBOLETA);
ALTER TABLE PRODUCTOS ADD CONSTRAINT PK_PRODUCTOS PRIMARY KEY(CODIGOPRODUCTO);

-- FK

ALTER TABLE BOLETA ADD CONSTRAINT FK_RUT_BOLETA FOREIGN KEY(RUT) REFERENCES CLIENTE(RUT) ON DELETE CASCADE;
ALTER TABLE DETALLE ADD CONSTRAINT FK_CODIGOPRODUCTO_DETALLE FOREIGN KEY (CODIGOPRODUCTO) REFERENCES PRODUCTOS(CODIGOPRODUCTO) ON DELETE CASCADE;
ALTER TABLE DETALLE ADD CONSTRAINT FK_CODIGOBOLETA_DETALLE FOREIGN KEY (CODIGOBOLETA) REFERENCES BOLETA(CODIGOBOLETA) ON DELETE CASCADE;

--Lenguaje manipulacion de los datos

--SENTENCIAS  DE INSERCTION (INSERT)
--SENTENCIAS DE MODIFICACION (UPDATE)
--SENTENCIAS DE ELIMINACION (DELETE)
--SENTENCIAS DE CONSULTA (SELECT)
--***********+
--SENTENCIAS INSERT Permite realizar una insercion de la informacion de una tabla nuestra en la base de datos

alter table cliente add fecha date;
select * from cliente;
INSERT INTO CLIENTE(RUT , NOMBRE , APELLIDOS ,CORREO, EDAD) VALUES ('129391232', 'JORGE','VALDES','COOKEXX47@GMAIL.COM',19);
INSERT INTO CLIENTE(RUT , NOMBRE , APELLIDOS ,CORREO, EDAD) VALUES ('8912382193', 'IGNACIO','FLORES','COOKEXX477@GMAIL.COM',19);
INSERT INTO CLIENTE(RUT, NOMBRE, APELLIDOS , CORREO , EDAD, FECHA) VALUES ('81923921213','VALERIA','ALBORNOZ','VALERIA@GMAIL.COM',19,'12/01/2020');
--*************
--SENTENCIAS UPDATE PERMITE REALIZAR UNA MODIFICACION DE INFROMACION SOBRE UNA TABLA DE LA BASE DE DATOS
--PARA LA MODIFICACION UNA O ON CONJUNTO DE LAS FILAS DEBE UTILIZARSE LA INSTRUCCION WHERE EN LA SENTENCIA

SELECT * FROM PRODUCTOS;

INSERT INTO PRODUCTOS(CODIGOPRODUCTO,NOMBRE, PRECIO , CATEGORIA) VALUES (1,'Notebook Lenovo',380.000,'Portables');
INSERT INTO PRODUCTOS(CODIGOPRODUCTO, NOMBRE, PRECIO , CATEGORIA) VALUES(2, 'CELULAR MOTOROLA', 110.000, ' TECNOLOGIA');
INSERT INTO PRODUCTOS(CODIGOPRODUCTO, NOMBRE , PRECIO , CATEGORIA) VALUES (3,'AUDIFONOS MACROTEL',3.500,'AUDIO');
INSERT INTO PRODUCTOS(CODIGOPRODUCTO, NOMBRE, PRECIO, CATEGORIA) VALUES (4, 'NOTEBOOK SAMSUNG',500.000, 'PORTABLES');
INSERT INTO PRODUCTOS(CODIGOPRODUCTO, NOMBRE, PRECIO , CATEGORIA) VALUES (5,'PANTALLA 17" AOC',67.900,'MONITORES');
INSERT INTO PRODUCTOS(CODIGOPRODUCTO, NOMBRE, PRECIO , CATEGORIA) VALUES (6,'PANTALLA 21" DELL',81.900, 'MONITORES');
INSERT INTO PRODUCTOS(CODIGOPRODUCTO, NOMBRE, PRECIO, CATEGORIA) VALUES (7,'NOTEBOOK HP',280.990,'PORTABLES');
INSERT INTO PRODUCTOS(CODIGOPRODUCTO, NOMBRE, PRECIO, CATEGORIA) VALUES (8, 'CELULAR IPHONE 6S',560.000,'TECNOLOGIA');
INSERT INTO PRODUCTOS(CODIGOPRODUCTO, NOMBRE, PRECIO, CATEGORIA) VALUES (9,'CELULAR LG',450.000,'TECNOLOGIA');
INSERT INTO PRODUCTOS(CODIGOPRODUCTO, NOMBRE, PRECIO, CATEGORIA) VALUES (10,'MOUSE BLUETOOH',28.990,'ACCESORIOS');
INSERT INTO PRODUCTOS(CODIGOPRODUCTO, NOMBRE, PRECIO , CATEGORIA) VALUES (11,'MONITOR 17 " SAMSUNG',150.000, ' MONITORES');
INSERT INTO PRODUCTOS(CODIGOPRODUCTO, NOMBRE , PRECIO , CATEGORIA) VALUES (12,'MONITOR 17 " LENOVO',250.000, 'MONITORES');
INSERT INTO PRODUCTOS(CODIGOPRODUCTO, NOMBRE, PRECIO, CATEGORIA) VALUES (13, 'MONITOR 17 "LG', 125.000, 'MONITORES');
INSERT INTO PRODUCTOS(CODIGOPRODUCTO, NOMBRE , PRECIO ,CATEGORIA) VALUES (14, 'MONITOR 15" LENOVO0',200.000, 'MONITORES');
INSERT INTO PRODUCTOS(CODIGOPRODUCTO, NOMBRE, PRECIO , CATEGORIA) VALUES (15, 'MOTO G 2013',130.000,'TECNOLOGIA');
INSERT INTO PRODUCTOS(CODIGOPRODUCTO, NOMBRE, PRECIO, CATEGORIA) VALUES(16, 'MOTO G 2015',180.000,'TECNOLOGOIA');
INSERT INTO PRODUCTOS(CODIGOPRODUCTO, NOMBRE, PRECIO, CATEGORIA) VALUES (17, 'MOTO X PLAY',370.000,'TECNOLOGIA');
INSERT INTO PRODUCTOS(CODIGOPRODUCTO, NOMBRE, PRECIO , CATEGORIA) VALUES (18,'IPAN MINI 2',200.000,'TABLETS');
INSERT INTO PRODUCTOS(CODIGOPRODUCTO, NOMBRE, PRECIO , CATEGORIA) VALUES (19,'IPAD AIR',260.000,'TABLETS');
INSERT INTO PRODUCTOS VALUES (20,'NOTEBOOK MSI',850000,'PORTABLES');
INSERT INTO PRODUCTOS VALUES (21,'MOUSE MICROSOFT',8500,'ACCESORIOS');

--VAMOS A CAMBIAR EL NOMBRE DE LA PRIMERA FILA DE NUESTRA TABLA DE DATOS PRODUCTOS
UPDATE PRODUCTOS SET NOMBRE = 'LENOVO NOTEBOOK' WHERE CODIGOPRODUCTO =1;
UPDATE PRODUCTOS SET NOMBRE = 'GG', PRECIO = 99999 WHERE CODIGOPRODUCTO=1;

--**************************+
--SENTENCIAS DELETE PERMITE ELIMINAR FILAS DE LA BASE DE DATOS , PARA UNA O UN CONJUNTO DE FILAS PARA TODA UNA TABLA
--PARA ELIMINAR UNA O UN CONJUTO DE FILAS, DEBE UTILIZARSE LA INSTRUCCION WHERE EN LA SENTENCIA DELETE

SELECT * FROM PRODUCTOS;
DELETE FROM PRODUCTOS WHERE PRECIO < 30000;

--SENTENCIAS SELECT PERMITE CONSULTAR LA INFORMACION DE UNA O MAS TABLAS PERTENECIENTES A LA BASE DE DATOS
--SE ABORDARA LAS CONSULTAS CON OPERADOR Y MANEJO DE FUNCIONES

SELECT NOMBRE FROM PRODUCTOS WHERE NOMBRE = 'GG';


--TENEMOS UN SIN FIN DE OPERADORES ARITMETICOS, COMPARATIVOS Y COMPUESTOS
--OPERADOR COMPUESTO AND

SELECT * FROM PRODUCTOS;
SELECT * FROM PRODUCTOS WHERE PRECIO>100.000 AND PRECIO<200.000;

--OPERADOR COMPUESTO BETWEEN, SE UTILIZA CUANDO QUEREMOS VERIFICAR UNA CONDICION SOBRE UN INTERVALO
--QUEREMOS CONSULTAR EL NOMRE Y PRECIO DE LOS PRODUCTOS DONDE EL PRECIO ES MAYOR A 100.000 Y MENOR A 200.000

SELECT * FROM PRODUCTOS WHERE PRECIO BETWEEN 100.000 AND 200.000;

--OPERADOR COMPUESTO OR CUANDO QUEREMOS ALGUNAS CONDICIONES SEAN VERDADERO POR SEPARADO
--OBTENDREMOS EL NOMBRE Y PRECIO Y CATEGORIA DE LOS PRODUCTOS  QUE TENGAN EL PRECIO MAYOR A 500000 O CATEGORIA IGUAL A TABLETS

SELECT * FROM PRODUCTOS WHERE PRECIO > 500.0000 OR CATEGORIA = 'TABLETS';

--OPERADOR COMPUESTO IN SE UTILIZA CUANDO QUEREMOS VERIFICAR SI EL OPERADOR ES IGUAL A UN ELEMENTO DE UNA LISTA DE EXPRESIONES

SELECT * FROM PRODUCTOS WHERE CODIGOPRODUCTO IN (5,6,7,12,18,20,21);
--OPCIONALMENTE ESTA CONSULTA LA PUEDO REALIZAR

SELECT * FROM PRODUCTOS WHERE CODIGOPRODUCTO >=5 AND CODIGOPRODUCTO <=7 OR CODIGOPRODUCTO = 12 OR CODIGOPRODUCTO = 18 OR CODIGOPRODUCTO = 20 OR CODIGOPRODUCTO =21;

--OPERADOR COMPUESTO LIKE , SE UTILIZA EN LA INSTRUCCION WHERE DEL SELECT CUANDO QUEREMOS VERIFICAR SI EL OPERADOR COINCIDE CON UN PATRON DEL TEXTO

SELECT NOMBRE , PRECIO FROM PRODUCTO WHERE NOMBRE LIKE'%C';

SELECT NOMBRE , PRECIO FROM PRODUCTO WHERE NOMBRE LIKE '%ES';

SELECT NOMBRE, PRECIO FROM PRODUCTO WHERE NOMBRE LIKE '%17%';

--OPERADOR COMPUESTO NOT
--SE UTILIZA EN LA INSTRUCCION WHERE DEL SELECT CUANDO QUEREMOS CONTRADECIR O NEGAR un OPERADOR
 SELECT NOMBRE , PRECIO FROM PRODUCTOS WHERE NOT PRECIO > 500000;

SELECT NOMBRE, PRECIO, CATEGORIA FROM PRODUCTOS WHERE CATEGORIA NOT LIKE '%ES';

SELECT NOMBRE , PRECIO FROM PRODUCTOS WHERE PRECIO NOT BETWEEN 100000 AND 200000;