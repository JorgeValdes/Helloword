/*DROP TABLE CATEGORIA;
DROP TABLE PRODUCTO;
DROP TABLE DETALLE;
DROP TABLE BOLETA;
DROP TABLE CLIENTE;

*/

CREATE TABLE CATEGORIA(

    CODIGO_CATEGORIA int not null,
    NOMBRE_CATEGORIA varchar(20)
)

CREATE TABLE PRODUCTO(
    CODIGO_PRODUCTO INT NOT NULL,
    NOMBRE VARCHAR(20),
    PRECIO INT,
    CODIGO_CATEGORIA INT,
    STOCK INT
)

CREATE TABLE DETALLE(

    CODIGO_PRODUCTO INT NOT NULL,
    CODIGO_BOLETA INT NOT NULL,
    CANTIDAD INT,
    PRECIO_UNITARIO INT,
    TOTAL_DETALLE INT
)

CREATE TABLE BOLETA(
    CODIGO_BOLETA INT NOT NULL,
    RUT INT,
    FECHA DATE,
    TOTAL INT
)

CREATE TABLE CLIENTE(
    RUT INT NOT NULL,
    NOMBRE VARCHAR(20),
    APELLIDOS VARCHAR(20),
    CORREO VARCHAR(50),
    EDAD INT

)

-- PK

ALTER TABLE CATEGORIA ADD CONSTRAINT PK_CATEGORIA PRIMARY KEY(CODIGO_CATEGORIA);
 
ALTER TABLE PRODUCTO ADD CONSTRAINT PK_PRODUCTO PRIMARY KEY(CODIGO_PRODUCTO);

ALTER TABLE BOLETA ADD CONSTRAINT PK_BOLETA PRIMARY KEY(CODIGO_BOLETA);

ALTER TABLE DETALLE ADD CONSTRAINT PK_DETALLE PRIMARY KEY(CODIGO_PRODUCTO, CODIGO_BOLETA);

ALTER TABLE CLIENTE ADD CONSTRAINT PK_CLIENTE PRIMARY KEY(RUT);

--FK

ALTER TABLE PRODUCTO ADD CONSTRAINT FK_CATEGORIA_PRODUCTO FOREIGN KEY (CODIGO_CATEGORIA) REFERENCES CATEGORIA(CODIGO_CATEGORIA) ON DELETE CASCADE;

ALTER TABLE DETALLE ADD CONSTRAINT FK_PRODUCTO_DETALLE FOREIGN KEY (CODIGO_PRODUCTO) REFERENCES PRODUCTO(CODIGO_PRODUCTO) ON DELETE CASCADE;
ALTER TABLE DETALLE ADD CONSTRAINT FK_BOLETA_DETALLE FOREIGN KEY(CODIGO_BOLETA) REFERENCES BOLETA(CODIGO_BOLETA) ON DELETE CASCADE;

ALTER TABLE BOLETA ADD CONSTRAINT FK_CLIENTE_BOLETA FOREIGN KEY(RUT) REFERENCES CLIENTE(RUT) ON DELETE CASCADE;

--
INSERT INTO CATEGORIA VALUES(1,'PORTABLES');
INSERT INTO CATEGORIA VALUES(2,'TECNOLOGIA');
INSERT INTO CATEGORIA VALUES(3,'AUDIO');
INSERT INTO CATEGORIA VALUES(4,'MONITORES');
INSERT INTO CATEGORIA VALUES(5,'ACCESORIOS');
INSERT INTO CATEGORIA VALUES(6,'TABLETS');

INSERT INTO PRODUCTO VALUES (1,'NOTEBOOK LENOVO',380000,1,20);
INSERT INTO PRODUCTO VALUES (2,'CELULAR MOTOROLA',110000,2,15);
INSERT INTO PRODUCTO VALUES (3,'AUDIFONOS MACROTEL',3500,3,12);
INSERT INTO PRODUCTO VALUES (4,'NOTEBOOK SAMSUNG',500000,1,3);
INSERT INTO PRODUCTO VALUES (5,'MONITOR 17" AOC',67990,4,80);
INSERT INTO PRODUCTO VALUES (6,'MONITOR 21" DELL',81990,4,20);
INSERT INTO PRODUCTO VALUES (7,'NOTEBOOK HP',280990,1,1);
INSERT INTO PRODUCTO VALUES (8,'CELULAR IPHONE 6S',560000,2,6);
INSERT INTO PRODUCTO VALUES (9,'CELULAR LG',450000,2,7);
INSERT INTO PRODUCTO VALUES (10,'MOUSE BLUETOOTH',28990,5,9);
INSERT INTO PRODUCTO VALUES (11,'MONITOR 17" SAMSUNG',150000,4,7);
INSERT INTO PRODUCTO VALUES (12,'MONITOR 17" LENOVO',250000,4,7);
INSERT INTO PRODUCTO VALUES (13,'MONITOR 17" LG',125000,4,4);
INSERT INTO PRODUCTO VALUES (14,'MONITOR 15" LENOVO',200000,4,3);
INSERT INTO PRODUCTO VALUES (15,'MOTO G 2013',130000,2,45);
INSERT INTO PRODUCTO VALUES (16,'MOTO G 2015',180000,2,32);
INSERT INTO PRODUCTO VALUES (17,'MOTO X PLAY',370000,2,12);
INSERT INTO PRODUCTO VALUES (18,'IPAD MINI 2',200000,6,4);
INSERT INTO PRODUCTO VALUES (19,'IPAD AIR',260000,6,2);
INSERT INTO PRODUCTO VALUES (20,'NOTEBOOK MSI',850000,1,4);
INSERT INTO PRODUCTO VALUES (21,'MOUSE MICROSOFT',8500,5,5);

select * from cliente;

INSERT INTO CLIENTE VALUES (145375682,'Alejandro','Sepulveda','alesepulveda@hotmail.com',39);
INSERT INTO CLIENTE VALUES (204821232,'Francisca','Perez','fran__xdperez2000@gmail.com',18);
INSERT INTO CLIENTE VALUES (185756203,'Felipe','Tapia','ftapia46@gmail.com',25);
INSERT INTO CLIENTE VALUES (85762340,'Camila','Fernandez','cfernandez@ucm.cl',58);
INSERT INTO CLIENTE VALUES (183447872,'Javiera','Faundez','javi_faundez94@gmail.com',24);
INSERT INTO CLIENTE VALUES (175682842,'Carlos','Hernandez','carlos_herna91@gmail.com',28);

INSERT INTO BOLETA VALUES (2,145375682,'14/08/2019',0);
INSERT INTO BOLETA VALUES (1,145375682,'12/07/2019',0);
INSERT INTO BOLETA VALUES (3,145375682,'17/08/2019',0);
INSERT INTO BOLETA VALUES (4,145375682,'24/08/2019',0);
INSERT INTO BOLETA VALUES (5,204821232,'12/08/2019',0);
INSERT INTO BOLETA VALUES (6,204821232,'16/08/2019',0);
INSERT INTO BOLETA VALUES (7,183447872,'02/09/2019',0);
INSERT INTO BOLETA VALUES (8,85762340,'10/09/2019',0);
INSERT INTO BOLETA VALUES (9,183447872,'16/09/2019',0);
INSERT INTO BOLETA VALUES (10,145375682,'20/09/2019',0);
INSERT INTO BOLETA VALUES (11,85762340,'01/10/2019',0);
INSERT INTO BOLETA VALUES (12,204821232,'11/10/2019',0);
INSERT INTO BOLETA VALUES (13,185756203,'12/10/2019',0);
INSERT INTO BOLETA VALUES (14,183447872,'05/11/2019',0);
INSERT INTO BOLETA VALUES (15,145375682,'08/11/2019',0);
INSERT INTO BOLETA VALUES (16,185756203,'12/12/2019',0);
INSERT INTO BOLETA VALUES (17,204821232,'12/12/2019',0);
INSERT INTO BOLETA VALUES (18,85762340,'21/12/2019',0);


INSERT INTO DETALLE VALUES(1,1,1,(SELECT PRECIO
                                  FROM PRODUCTO
                                  WHERE CODIGO_PRODUCTO = 1), (SELECT PRECIO
                                                               FROM PRODUCTO
                                                               WHERE CODIGO_PRODUCTO = 1)*1);  
INSERT INTO DETALLE VALUES(21,1,1,(SELECT PRECIO
                                  FROM PRODUCTO
                                  WHERE CODIGO_PRODUCTO = 21), (SELECT PRECIO
                                                               FROM PRODUCTO
                                                               WHERE CODIGO_PRODUCTO = 21)*1);  
INSERT INTO DETALLE VALUES(2,2,1,(SELECT PRECIO
                                  FROM PRODUCTO
                                  WHERE CODIGO_PRODUCTO = 2), (SELECT PRECIO
                                                               FROM PRODUCTO
                                                               WHERE CODIGO_PRODUCTO = 2)*1);                                                                
INSERT INTO DETALLE VALUES(6,3,1,(SELECT PRECIO
                                  FROM PRODUCTO
                                  WHERE CODIGO_PRODUCTO = 6), (SELECT PRECIO
                                                               FROM PRODUCTO
                                                               WHERE CODIGO_PRODUCTO = 6)*1);  
INSERT INTO DETALLE VALUES(3,4,1,(SELECT PRECIO
                                  FROM PRODUCTO
                                  WHERE CODIGO_PRODUCTO = 3), (SELECT PRECIO
                                                               FROM PRODUCTO
                                                               WHERE CODIGO_PRODUCTO = 3)*1); 
INSERT INTO DETALLE VALUES(17,5,1,(SELECT PRECIO
                                  FROM PRODUCTO
                                  WHERE CODIGO_PRODUCTO = 17), (SELECT PRECIO
                                                               FROM PRODUCTO
                                                               WHERE CODIGO_PRODUCTO = 17)*1); 
INSERT INTO DETALLE VALUES(17,6,1,(SELECT PRECIO
                                  FROM PRODUCTO
                                  WHERE CODIGO_PRODUCTO = 17), (SELECT PRECIO
                                                               FROM PRODUCTO
                                                               WHERE CODIGO_PRODUCTO = 17)*1); 
INSERT INTO DETALLE VALUES(19,7,1,(SELECT PRECIO
                                  FROM PRODUCTO
                                  WHERE CODIGO_PRODUCTO = 19), (SELECT PRECIO
                                                               FROM PRODUCTO
                                                               WHERE CODIGO_PRODUCTO = 19)*1);
INSERT INTO DETALLE VALUES(21,8,2,(SELECT PRECIO
                                  FROM PRODUCTO
                                  WHERE CODIGO_PRODUCTO = 21), (SELECT PRECIO
                                                               FROM PRODUCTO
                                                               WHERE CODIGO_PRODUCTO = 21)*2);                                                                
INSERT INTO DETALLE VALUES(2,9,1,(SELECT PRECIO
                                  FROM PRODUCTO
                                  WHERE CODIGO_PRODUCTO = 2), (SELECT PRECIO
                                                               FROM PRODUCTO
                                                               WHERE CODIGO_PRODUCTO = 2)*1); 
INSERT INTO DETALLE VALUES(8,10,1,(SELECT PRECIO
                                  FROM PRODUCTO
                                  WHERE CODIGO_PRODUCTO = 8), (SELECT PRECIO
                                                               FROM PRODUCTO
                                                               WHERE CODIGO_PRODUCTO = 8)*1);                                                                
INSERT INTO DETALLE VALUES(3,11,2,(SELECT PRECIO
                                  FROM PRODUCTO
                                  WHERE CODIGO_PRODUCTO = 3), (SELECT PRECIO
                                                               FROM PRODUCTO
                                                               WHERE CODIGO_PRODUCTO = 3)*2);   
INSERT INTO DETALLE VALUES(7,12,1,(SELECT PRECIO
                                  FROM PRODUCTO
                                  WHERE CODIGO_PRODUCTO = 7), (SELECT PRECIO
                                                               FROM PRODUCTO
                                                               WHERE CODIGO_PRODUCTO = 7)*1); 
INSERT INTO DETALLE VALUES(19,13,1,(SELECT PRECIO
                                  FROM PRODUCTO
                                  WHERE CODIGO_PRODUCTO = 19), (SELECT PRECIO
                                                               FROM PRODUCTO
                                                               WHERE CODIGO_PRODUCTO = 19)*1);       
INSERT INTO DETALLE VALUES(20,13,1,(SELECT PRECIO
                                  FROM PRODUCTO
                                  WHERE CODIGO_PRODUCTO = 20), (SELECT PRECIO
                                                               FROM PRODUCTO
                                                               WHERE CODIGO_PRODUCTO = 20)*1);   
INSERT INTO DETALLE VALUES(21,13,1,(SELECT PRECIO
                                  FROM PRODUCTO
                                  WHERE CODIGO_PRODUCTO = 21), (SELECT PRECIO
                                                               FROM PRODUCTO
                                                               WHERE CODIGO_PRODUCTO = 21)*1);   
INSERT INTO DETALLE VALUES(6,13,1,(SELECT PRECIO
                                  FROM PRODUCTO
                                  WHERE CODIGO_PRODUCTO = 6), (SELECT PRECIO
                                                               FROM PRODUCTO
                                                               WHERE CODIGO_PRODUCTO = 6)*1);
INSERT INTO DETALLE VALUES(2,14,3,(SELECT PRECIO
                                  FROM PRODUCTO
                                  WHERE CODIGO_PRODUCTO = 2), (SELECT PRECIO
                                                               FROM PRODUCTO
                                                               WHERE CODIGO_PRODUCTO = 2)*3);
INSERT INTO DETALLE VALUES(5,14,1,(SELECT PRECIO
                                  FROM PRODUCTO
                                  WHERE CODIGO_PRODUCTO = 5), (SELECT PRECIO
                                                               FROM PRODUCTO
                                                               WHERE CODIGO_PRODUCTO = 5)*1);     
INSERT INTO DETALLE VALUES(10,15,1,(SELECT PRECIO
                                  FROM PRODUCTO
                                  WHERE CODIGO_PRODUCTO = 10), (SELECT PRECIO
                                                               FROM PRODUCTO
                                                               WHERE CODIGO_PRODUCTO = 10)*1);                                                                    
INSERT INTO DETALLE VALUES(9,15,1,(SELECT PRECIO
                                  FROM PRODUCTO
                                  WHERE CODIGO_PRODUCTO = 9), (SELECT PRECIO
                                                               FROM PRODUCTO
                                                               WHERE CODIGO_PRODUCTO = 9)*1);                                                              
INSERT INTO DETALLE VALUES(10,16,1,(SELECT PRECIO
                                  FROM PRODUCTO
                                  WHERE CODIGO_PRODUCTO = 10), (SELECT PRECIO
                                                               FROM PRODUCTO
                                                               WHERE CODIGO_PRODUCTO = 10)*1);       
INSERT INTO DETALLE VALUES(15,17,1,(SELECT PRECIO
                                  FROM PRODUCTO
                                  WHERE CODIGO_PRODUCTO = 15), (SELECT PRECIO
                                                               FROM PRODUCTO
                                                               WHERE CODIGO_PRODUCTO = 15)*1);  
INSERT INTO DETALLE VALUES(20,18,1,(SELECT PRECIO
                                  FROM PRODUCTO
                                  WHERE CODIGO_PRODUCTO = 20), (SELECT PRECIO
                                                               FROM PRODUCTO
                                                               WHERE CODIGO_PRODUCTO = 20)*1);           

										
SELECT * FROM BOLETA;
SELECT * FROM DETALLE;
UPDATE BOLETA  SET BOLETA.TOTAL = (SELECT SUM(DETALLE.TOTAL_DETALLE) FROM DETALLE   WHERE DETALLE.CODIGO_BOLETA = BOLETA.CODIGO_BOLETA);

SELECT * FROM DETALLE;
SELECT * FROM CLIENTE;
SELECT * FROM PRODUCTO;
SELECT * FROM BOLETA;
SELECT * FROM CATEGORIA;

-- La sentencia select es la que posee mayor cantidad de operadores, funciones e instrucciones para realizar las consultas
--hoy abordaremos las consultas multiples tablas y consultas de agrupacion

SELECT * FROM CLIENTE RIGHT JOIN BOLETA ON CLIENTE.RUT = BOLETA.RUT WHERE CLIENTE.RUT = 204821232;
SELECT * FROM CLIENTE;
SELECT * FROM BOLETA;
SELECT * FROM DETALLE;
SELECT * FROM PRODUCTO;
SELECT C.RUT , C.NOMBRE, C.APELLIDOS, C.CORREO , C.EDAD , B.FECHA, B.TOTAL, D.CODIGO_PRODUCTO, D.CODIGO_BOLETA, D.CANTIDAD,D.PRECIO_UNITARIO, D.TOTAL_DETALLE AS TOTAL_DETALLE , P.CODIGO_PRODUCTO,
P.NOMBRE, P.PRECIO , P.CODIGO_CATEGORIA , P.STOCK
FROM CLIENTE C INNER JOIN BOLETA B ON C.RUT = B.RUT INNER JOIN DETALLE D ON B.CODIGO_BOLETA = D.CODIGO_BOLETA INNER JOIN PRODUCTO P ON D.CODIGO_PRODUCTO = P.CODIGO_PRODUCTO WHERE C.RUT= 204821232;

--preejercicio
/*Para
esto, mostraremos el rut
y nombre de cliente, el código
y nombre del producto y por
último, la fecha de compra y
el total de la boleta*/
SELECT * FROM PRODUCTO;
SELECT * FROM DETALLE;
SELECT * FROM BOLETA;
SELECT * FROM DETALLE;
SELECT C.RUT , C.NOMBRE , P.CODIGO_PRODUCTO , P.NOMBRE , B.FECHA , B.TOTAL FROM CLIENTE C INNER JOIN BOLETA B ON C.RUT = B.RUT INNER JOIN DETALLE D ON B.CODIGO_BOLETA = D.CODIGO_BOLETA 
INNER JOIN PRODUCTO P ON D.CODIGO_PRODUCTO = P.CODIGO_PRODUCTO WHERE C.RUT = 204821232;

--lo que acabamos de visualizar  es el join explicito e Implicito

--JOIN IMPLICITO REALIZANDO LA MISMA CONSULTA

SELECT C.RUT , C.NOMBRE ,P.CODIGO_PRODUCTO , P.NOMBRE AS NOMBRE_PRODUCTO , B.FECHA , B.TOTAL FROM CLIENTE C , BOLETA B , PRODUCTO P , DETALLE D WHERE C.RUT = B.RUT AND B.CODIGO_BOLETA = D.CODIGO_BOLETA
AND D.CODIGO_PRODUCTO = P.CODIGO_PRODUCTO AND C.RUT = 204821232;

--INNER JOIN
--FULL JOIN
--LEFT JOIN
--RIGHT JOIN

--ejemplo de left outer join
--retorna todos los registros de la tabla de la "izquierda" , aun cuando no exista un registro correspondiente en la tabla de la derecha.

SELECT * FROM CLIENTE INNER JOIN BOLETA ON CLIENTE.RUT = BOLETA.RUT;
SELECT * FROM CLIENTE LEFT OUTER JOIN BOLETA ON CLIENTE.RUT = BOLETA.RUT;

--ejemplo de right outer join
--retorna todos los registros de la tabla de la derecha , aun cuando exista un registro correspondiente en la tabla de la izq.


SELECT * FROM BOLETA B RIGHT OUTER JOIN CLIENTE C ON B.RUT = C.RUT;
SELECT * FROM CLIENTE C LEFT OUTER JOIN BOLETA B ON C.RUT = B.RUT;


--FULL JOIN  RETORNA TODOS LOS REGISTROS DE LA TABLA DE LA "DERECHA" , AUN CUANDO NO EXISTA UN REGISTRO CORRESPONDIENTE EN LA TABLA DE LA "IZQUIERDA" Y RETORNA TODOS LOS REGISTROS DE LA TABLA
--"IZQUIERDA" , AUN CUANDO NO EXISTA UN REGISTRO CORRESPONDIENTE EN LA TABLA DE LA "DERECHA"

--FULL OUTER JOIN, ES DECIR MUESTRA TODO LO QUE COINCIDE Y NO COINCIDE DE AMBAS TABLAS

SELECT * FROM BOLETA B FULL OUTER JOIN CLIENTE C ON B.RUT = C.RUT;

--Consultas de Agrupacion
--Para realizar estos resumenes las consultas de agrupacion cuentan con las siguientes funciones: 
/*
AVG
Calcula el promedio sobre una columna
COUNT
Realiza el conteo sobre una columna
MAX
Calcula el máximo valor sobre una columna
MIN
Calcula el mínimo valor sobre una columna
STDDEV
Calcula la desviación estándar sobre una columna
SUM
Realiza la suma sobre una columna
VARIANCE
Calcula la varianza sobre una columna
*/

SELECT * FROM CLIENTE;
SELECT * FROM BOLETA;


SELECT C.RUT , C.NOMBRE , B.FECHA ,SUM(B.TOTAL) AS TOTAL_DETALLE FROM CLIENTE C INNER JOIN BOLETA B ON C.RUT=B.RUT GROUP BY C.NOMBRE , C.RUT, B.FECHA;

SELECT RUT , SUM(TOTAL)AS TOTAL_VENTA FROM BOLETA GROUP BY RUT;

select * from boleta;
--CONSULTA 1
--OBTENER LA SUMA DE TODAS LAS VENTAS DE LA TABLA BOLETA (TOTAL)

SELECT SUM(TOTAL) AS TOTAL_VENTAS FROM BOLETA;
--CONSULTA 2
--OBTENER EL PROMEDIO DE EDAD DE LOS CLIENTES



SELECT AVG(EDAD) AS PROMEDIO_EDAD
FROM CLIENTE;
--CONSULTA 3
--OBTENER EL CONTEO DE PRODUCTOS DE LA TABLA PRODUCTO
SELECT COUNT(CODIGO_PRODUCTO) FROM PRODUCTO;

--CONSULTA 4
--OBTENER DE LAS TABLAS PRODUCTO Y CATEGORIA (UTILIZACIÓN DE JOIN EXPLÍCITO)
--MOSTRAR EL CODIGO, NOMBRE Y PRECIO DE LA TABLA PRODUCTO
--MOSTRAR EL NOMBRE DE LA CATEGORIA DEL PRODUCTO
SELECT * FROM PRODUCTO;
SELECT * FROM CATEGORIA;

SELECT PRODUCTO.CODIGO_PRODUCTO , PRODUCTO.NOMBRE, PRODUCTO.PRECIO , CATEGORIA.NOMBRE_CATEGORIA FROM PRODUCTO INNER JOIN CATEGORIA ON PRODUCTO.CODIGO_CATEGORIA = CATEGORIA.CODIGO_CATEGORIA;
--CONSULTA 5
--REALIZA LA MISMA CONSULTA ANTERIOR UTILIZANDO JOIN IMPLÍCITO

SELECT * FROM PRODUCTO;
SELECT CODIGO_PRODUCTO , NOMBRE , PRECIO , NOMBRE_CATEGORIA FROM PRODUCTO  , CATEGORIA WHERE PRODUCTO.CODIGO_CATEGORIA = CATEGORIA.CODIGO_CATEGORIA; 

--CONSULTA 6
--REALICE LA CONSULTA 4 UTILIZANDO NATURAL JOIN
SELECT * FROM CATEGORIA;
/*SELECT P.CODIGO_PRODUCTO, P.NOMBRE, P.PRECIO, C.NOMBRE_CATEGORIA
FROM PRODUCTO P NATURAL JOIN CATEGORIA C;
*/

--CONSULTA 7
--SE QUIERE SABER INFORMACIÓN DEL CLIENTE ASOCIADO A CADA CODIGO DE BOLETA
--MUESTRE EL RUT, NOMBRE DEL CLIENTE ADEMÁS DEL CODIGO DE BOLETA Y EL TOTAL DE LA BOLETA ASOCIADO

SELECT * FROM BOLETA;
SELECT * FROM CLIENTE;
SELECT C.RUT , C.NOMBRE ,B.CODIGO_BOLETA , B.TOTAL FROM CLIENTE C INNER JOIN BOLETA B ON C.RUT = B.RUT;
--CONSULTA 8
--AGREGUE A LA CONSULTA ANTERIOR LA INSTRUCCIÓN ORDER BY
--ORDENE EL RESULTADO EN FUNCIÓN AL TOTAL, EN FORMA DESCENDENTE

SELECT C.RUT , C.NOMBRE ,B.CODIGO_BOLETA , B.TOTAL AS TOTAL FROM CLIENTE C INNER JOIN BOLETA B ON C.RUT = B.RUT ORDER BY TOTAL DESC;

--CONSULTA 9
--SE DESEAN SABER LOS CODIGOS DE BOLETA CORRESPONDIENTES AL MES DE AGOSTO

SELECT * FROM DETALLE;
SELECT * FROM CLIENTE;
SELECT * FROM PRODUCTO;
SELECT * FROM BOLETA;
SELECT B.CODIGO_BOLETA , B.FECHA FROM BOLETA B WHERE B.FECHA BETWEEN '2019-08-01' AND '2019-08-31';

--CONSULTA 10
--MUESTRE TODOS LOS CLIENTES QUE COMPRARON PRODUCTOS ENTRE AGOSTO Y OCTUBRE
--DEBE MOSTRAR RUT, NOMBRE Y FECHA (UTILICE JOIN EXPLÍCITO)
SELECT * FROM BOLETA;
SELECT C.RUT , C.NOMBRE , B.FECHA FROM CLIENTE C INNER JOIN BOLETA B ON C.RUT = B.RUT WHERE B.FECHA BETWEEN '2019-08-01' AND '2019-10-31'; 

--CONSULTA 11
--MUESTRE LA CANTIDAD DE VECES QUE SE HA COMPRADO UN PRODUCTO
--DEBE MOSTRAR EL CODIGO Y NOMBRE DEL PRODUCTO Y LA CANTIDAD DE VECES QUE SE COMPRÓ
SELECT * FROM DETALLE;
SELECT P.CODIGO_PRODUCTO , P.NOMBRE , SUM(D.CANTIDAD) AS TOTAL FROM PRODUCTO P INNER JOIN DETALLE D ON P.CODIGO_PRODUCTO=D.CODIGO_PRODUCTO GROUP BY P.CODIGO_PRODUCTO, P.NOMBRE;
--CONSULTA 12 (BELICA)
--AGREGAR A LA CONSULTA ANTERIOR, QUE MUESTRE SOLAMENTE LA INFORMACIÓN PARA
--LOS PRODUCTOS CUYA CATEGORIA TERMINE CON LA LETRA "A" U "O"
--ORDENAR POR CANTIDAD DE PRODUCTO COMPRADO EN FORMA DESCENDENTE

SELECT P.CODIGO_PRODUCTO, P.NOMBRE , SUM(D.CANTIDAD) AS TOTAL FROM PRODUCTO P INNER JOIN DETALLE D ON P.CODIGO_PRODUCTO = D.CODIGO_PRODUCTO INNER JOIN CATEGORIA ON P.CODIGO_CATEGORIA = CATEGORIA.CODIGO_CATEGORIA
WHERE CATEGORIA.NOMBRE_CATEGORIA LIKE '%A' OR CATEGORIA.NOMBRE_CATEGORIA LIKE '%O' GROUP BY P.CODIGO_PRODUCTO , P.NOMBRE ORDER BY TOTAL DESC;

--CONSULTA 13 - UN PRODUCTO DE LA CONSULTA ANTERIOR NO SE MUESTRA
--UTILICE UN LEFT OUTER O RIGHT OUTER JOIN PARA MOSTRAR EL PRODUCTO QUE NO HA SIDO COMPRADO NINGUNA VEZ


--CONSULTA 14
--MUESTRE EL STOCK DISPONIBLE Y LA CANTIDAD DE PRODUCTOS POR CADA CATEGORIA


--CONSULTA 15
--MUESTRE LA CANTIDAD DE PRODUCTOS VENDIDOS Y EL TOTAL DE VENTAS POR CADA MES
--EL MES DEBE MOSTRARSE POR NOMBRE
--ORDENE LOS RESULTADOS ALFABETICAMENTE POR MES


--CONSULTA 16
--MUESTRE LA CANTIDAD DE PRODUCTOS QUE COMPRO FRANCISCA, CAMILA Y JAVIERA
--MUESTRE EL NOMBRE DEL CLIENTE


--CONSULTA 17
--MUESTRE LA CANTIDAD DE COMPRAS QUE HA REALIZADO CADA CLIENTE
--MUESTRE EL NOMBRE DEL CLIENTE
--ORDENAR A CADA CLIENTE POR LA CANTIDAD DE COMPRAS QUE REALIZÓ EN FORMA DESCENDENTE


--CONSULTA 18
--MUESTRE LOS PRODUCTOS PERTENECIENTES A CADA BOLETA
--MUESTRE EL CODIGO_BOLETA, CODIGO_PRODUCTO, NOMBRE_PRODUCTO, CANTIDAD DE PRODUCTOS
--ORDENAR POR CODIGO DE BOLETA EN FORMA ASCENDENTE


--CONSULTA 19 (BELICA)
--MUESTRE LOS PRODUCTOS QUE FUERON COMPRADOS ENTRE EL 12 DE AGOSTO Y EL 08 DE NOVIEMBRE Y QUE LA CANTIDAD SEA MAYOR O IGUAL A 2
--EN LA CONSULTA SE DEBE MOSTRAR EL RUT Y NOMBRE DEL CLIENTE QUE COMPRÓ LOS PRODUCTOS
--LA FECHA DE LA BOLETA
--CODIGO, NOMBRE, PRECIO, CANTIDAD Y TOTAL DE LOS PRODUCTOS
--NOMBRE DE LA CATEGORIA DEL PRODUCTO


--CONSULTA 20 
--CONSIDERE QUE EN LA TABLA PRODUCTO ESTÁ EL INVENTARIO RESTANTE DE LA "TIENDA"
--MUESTRE LA CANTIDAD TOTAL DE DINERO QUE REPRESENTA EL INVENTARIO DE LA TIENDA

